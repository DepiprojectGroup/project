pipeline {
    agent any
    
    stages {
        stage('Deploy Everything') {
            steps {
                bat '''
                    @echo off
                    echo ========================================
                    echo ğŸš€ Ù†Ø´Ø± ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
                    echo ========================================
                    
                    echo [1] ØªØ´ØºÙŠÙ„ Minikube...
                    minikube start --driver=docker --force
                    
                    echo [2] ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹...
                    git clone https://github.com/DepiprojectGroup/project.git
                    
                    echo [3] Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...
                    cd project/k8s-manifests
                    
                    kubectl create namespace ordering-system
                    kubectl create deployment backend --image=nginx:alpine -n ordering-system
                    kubectl create deployment frontend --image=nginx:alpine -n ordering-system
                    kubectl expose deployment backend --port=80 --target-port=80 -n ordering-system
                    kubectl expose deployment frontend --port=80 --target-port=80 -n ordering-system
                    
                    echo [4] Ø§Ù†ØªØ¸Ø§Ø± 20 Ø«Ø§Ù†ÙŠØ©...
                    ping -n 20 127.0.0.1 > nul
                    
                    echo [5] Ø§Ù„Ù†ØªÙŠØ¬Ø©:
                    kubectl get pods,svc -n ordering-system
                    
                    echo [6] Ø§ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:
                    echo.
                    echo ğŸŒ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1: kubectl port-forward -n ordering-system service/frontend 8080:80
                    echo ğŸŒ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2: minikube service frontend -n ordering-system
                '''
            }
        }
    }
}